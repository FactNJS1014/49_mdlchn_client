const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./Bt8TcQSn.js","./BjB7BAY6.js","./entry.CloCiwpS.css"])))=>i.map(i=>d[i]);
import{d as Z,r as f,ac as at,x as tt,y as w,z as t,A as i,D as r,ad as X,ae as K,n as lt,o as st,I as V,C as n,a0 as W,ab as H,g as ot,B as s,af as nt,a4 as _,ag as it,U as dt,ah as rt,ai as ct,W as ut,aj as mt,a5 as y,a1 as G,ak as pt,al as gt,am as ft,aa as vt,Y as Q,a7 as Ct,an as _t,q as Rt}from"#entry";import{d as et}from"./BtPkePTV.js";import{S as $}from"./Bj_ZQUAw.js";const Pt={class:"flex justify-center text-lg font-bold align-center"},Et={class:"pa-3 border border-black w-[800px] bg-white mt-3 mb-5 space-y-2"},xt={class:"grid grid-cols-3 gap-4"},Ot={class:"grid grid-cols-1 gap-4"},ht={class:"flex items-center gap-2"},kt=["checked"],wt=["checked"],bt=["checked"],Ht=["checked"],yt=["checked"],Nt={class:"grid grid-cols-2 gap-4"},Dt={class:"grid grid-cols-2 gap-4"},It={class:"grid grid-cols-1 gap-4"},St={class:"flex items-center gap-2"},Mt=["checked"],Vt=["checked"],At={class:"ms-3"},Tt={class:"grid grid-cols-2 gap-4"},Lt=Z({__name:"cpdocs",props:{dataItem:{}},setup(o){const A=o,p=f(null),P=c=>et(c).format("DD/MM/YYYY");at(()=>A.dataItem,async c=>{c&&(await X(),N())},{immediate:!0});const N=async()=>{if(!p.value)return;const c=p.value;c.style.display="block",c.style.position="absolute",c.style.left="-9999px",c.style.top="0",c.style.opacity="1",c.style.fontSize="12px",document.body.appendChild(c),await X();const a=(await K(async()=>{const{default:R}=await import("./B0tyYwQk.js");return{default:R}},[],import.meta.url)).default,{jsPDF:D}=await K(async()=>{const{jsPDF:R}=await import("./Bt8TcQSn.js").then(k=>k.j);return{jsPDF:R}},__vite__mapDeps([0,1,2]),import.meta.url),g=await a(c,{scale:2,useCORS:!0}),E=new D("p","mm","a4"),I=E.internal.pageSize.getWidth(),x=E.internal.pageSize.getHeight(),O=10,h=x-O-2,M=I,F=M/g.width,T=g.width/M,U=20*T;let C=0,L=!0;const B=Array.from(c.children);for(;C<g.height;){L||E.addPage();let R=h*T,k=C+R,l=R;for(const j of B){const b=j.offsetTop*2,J=(j.offsetTop+j.offsetHeight)*2;if(b>=C){if(b<k&&J>k){l=b-C;break}const q=k-b;if(J-b>q||q<U){l=b-C;break}}}l=Math.min(l,g.height-C),l<=0&&(l=R);const e=l,d=document.createElement("canvas");d.width=g.width,d.height=e,d.getContext("2d").drawImage(g,0,C,g.width,e,0,0,g.width,e);const u=d.toDataURL("image/jpeg",1),m=O,Y=e*F;E.addImage(u,"JPEG",0,m,M,Y),C+=e,L=!1}window.open(E.output("bloburl"),"_blank"),c.style.display="none"};return(c,a)=>(w(),tt("div",{ref_key:"pdfTemplate",ref:p,class:"hidden pa-2"},[t("p",Pt," MODEL CHANGE RECORD SMT PROCESS : "+i(o.dataItem?.OPR_HREC_PROCS),1),t("div",Et,[t("div",xt,[t("div",null,[a[0]||(a[0]=t("strong",null,"Line:",-1)),r(" "+i(o.dataItem?.OPR_HREC_LINE),1)]),t("div",null,[a[1]||(a[1]=t("strong",null,"Date:",-1)),r(" "+i(P(o.dataItem?.OPR_HREC_DATEREC)),1)]),t("div",null,[a[2]||(a[2]=t("strong",null,"Document No.:",-1)),r(" "+i(o.dataItem?.OPR_HREC_ISSUENO.split("-").pop().slice(-3)),1)])]),t("div",Ot,[t("div",ht,[a[3]||(a[3]=t("strong",null,"Status:",-1)),t("input",{type:"checkbox",class:"w-4 h-4 mt-3",checked:o.dataItem?.OPR_HREC_STATUSMDL==="Urgent"},null,8,kt),a[4]||(a[4]=t("span",null,"Urgent",-1)),t("input",{type:"checkbox",class:"w-4 h-4 mt-3",checked:o.dataItem?.OPR_HREC_STATUSMDL==="Normal"},null,8,wt),a[5]||(a[5]=t("span",null,"Normal",-1)),t("input",{type:"checkbox",class:"w-4 h-4 mt-3",checked:o.dataItem?.OPR_HREC_STATUSMDL==="New Line"},null,8,bt),a[6]||(a[6]=t("span",null,"New Line",-1)),t("input",{type:"checkbox",class:"w-4 h-4 mt-3",checked:o.dataItem?.OPR_HREC_STATUSMDL==="New model"},null,8,Ht),a[7]||(a[7]=t("span",null,"New model",-1)),t("input",{type:"checkbox",class:"w-4 h-4 mt-3",checked:o.dataItem?.OPR_HREC_STATUSMDL==="Over Plan"},null,8,yt),a[8]||(a[8]=t("span",null,"Over Plan",-1))])]),t("div",Nt,[t("div",null,[a[9]||(a[9]=t("strong",null,"Current Model Code:",-1)),r(" "+i(o.dataItem?.OPR_HREC_CURMDLNM),1)]),t("div",null,[a[10]||(a[10]=t("strong",null,"Change Model Code:",-1)),r(" "+i(o.dataItem?.OPR_HREC_CHNMDLNM),1)])]),t("div",Dt,[t("div",null,[a[11]||(a[11]=t("strong",null,"WO#:",-1)),r(" "+i(o.dataItem?.OPR_HREC_WON_CURRENT)+" ",1),a[12]||(a[12]=t("strong",{class:"ms-3"},"Lot Size:",-1)),r(" "+i(o.dataItem?.OPR_HREC_LOTS)+" pcs. ",1),a[13]||(a[13]=t("strong",{class:"ms-3"},"Process:",-1)),r(" "+i(o.dataItem?.OPR_HREC_PROCSCP),1)]),t("div",null,[a[14]||(a[14]=t("strong",null,"WO#:",-1)),r(" "+i(o.dataItem?.OPR_HREC_WON_CHANGE)+" ",1),a[15]||(a[15]=t("strong",{class:"ms-3"},"Lot Size:",-1)),r(" "+i(o.dataItem?.OPR_HREC_LOTS_CHN)+" pcs. ",1),a[16]||(a[16]=t("strong",{class:"ms-3"},"Process:",-1)),r(" "+i(o.dataItem?.OPR_HREC_PROCSCP_CHN),1)])]),t("div",It,[t("div",St,[a[19]||(a[19]=t("strong",null,"ECN Control:",-1)),t("input",{type:"checkbox",class:"w-4 h-4 mt-3",checked:o.dataItem?.OPR_HREC_CONTECN==="No Have"},null,8,Mt),a[20]||(a[20]=t("span",null,"No Have",-1)),t("input",{type:"checkbox",class:"w-4 h-4 mt-3",checked:o.dataItem?.OPR_HREC_CONTECN==="Have"},null,8,Vt),a[21]||(a[21]=t("span",null,"Have",-1)),t("div",At,[a[17]||(a[17]=t("strong",null,"ECN Number:",-1)),t("span",null,i(o.dataItem?.OPR_HREC_CONTECN==="No Have"?"à¹„à¸¡à¹ˆà¸¡à¸µ":o.dataItem?.OPR_HREC_HAVECONTECN_NO),1),a[18]||(a[18]=t("strong",{class:"ms-3"},"ECN REV:",-1)),t("span",null,i(o.dataItem?.OPR_HREC_CONTECN==="No Have"?"à¹„à¸¡à¹ˆà¸¡à¸µ":o.dataItem?.OPR_HREC_HAVECONTECN_REV),1)])])]),t("div",Tt,[t("div",null,[a[22]||(a[22]=t("strong",null,"Program name:",-1)),r(" "+i(o.dataItem?.OPR_HREC_PRGMNM),1)]),t("div",null,[a[23]||(a[23]=t("strong",null,"REV.:",-1)),r(" "+i(o.dataItem?.OPR_HREC_PRGMREV),1)])])])],512))}}),$t=Object.assign(Lt,{__name:"Cpdocs"}),Ft={class:"flex justify-between align-center w-[500px]"},Ut={class:"mb-2 text-h6"},Bt={class:"border border-blue-800"},Yt={class:"border"},jt={class:"px-2 text-sky-800"},Wt={class:"border"},Gt={class:"px-2 text-sky-800"},zt={class:"border"},Jt={class:"px-2 text-sky-800"},qt={class:"border"},Xt={class:"px-2 text-sky-800"},Kt={class:"px-4 d-flex justify-space-between"},Qt={class:"d-flex align-center text-caption text-medium-emphasis me-1"},Zt={class:"justify-center d-flex align-center pa-4"},te={class:"mx-2 text-caption"},oe=Z({__name:"dataApp",setup(o){const{public:A}=lt();console.log(A.apiBase);const p=f(null),P=f(""),N=f(""),c=async()=>{const l=await H.get(`${A.apiBase}/session/user`,{withCredentials:!0});p.value=l.data,console.log("user session:",p.value),P.value=p.value?.empno||""},a=f(""),D=f([]),g=f(!1),E=f(null),I=f(null),x=f(null),O=f(null),S=f(null),h=f([]),M=async()=>{try{const l=await H.get("http://172.22.64.11/49_modelchange/49_mdlchn_api/api/get/alldata",{params:{empno:P.value}});D.value=l.data.cp,I.value=l.data.app_cp,S.value=[],x.value=[],O.value=[],console.log("ðŸ“¦ All Data:",D.value),console.log("ðŸ“‹ Approval Data:",I.value),I.value.forEach(e=>{const d=e.APP_REC_EMPNO.includes(",")?e.APP_REC_EMPNO.split(","):[e.APP_REC_EMPNO];console.log("ðŸ” Checking APP_REC_EMPNO:",d,"for empno:",P.value),d.includes(P.value)&&(S.value.push(e.OPR_HREC_ID),x.value.push(e.APP_REC_LEVEL)),d.forEach(v=>{O.value.includes(v)||O.value.push(v)})}),console.log("âœ… Final APP_LEV:",x.value),console.log("âœ… Final APP_EMP:",O.value),console.log("âœ… Final OPR_HREC_ID:",S.value)}catch(l){console.error(l)}},F=async l=>{const e=await H.put("http://172.22.64.11/49_modelchange/49_mdlchn_api/api/update/reject",l);console.log(e.data),e.data.success===!0&&$.fire({icon:"success",title:"à¸ªà¹ˆà¸‡à¸à¸¥à¸±à¸šà¹„à¸›à¹à¸à¹‰à¹„à¸‚à¸ªà¸³à¹€à¸£à¹‡à¸ˆ",showConfirmButton:!1,timer:1500,timerProgressBar:!0}).then(()=>{location.reload()})},T=()=>{console.log("ðŸ”¹ Start filtering data"),h.value=[],D.value.forEach(l=>{const e=l.OPR_HREC_SENDAPP_STD;let d=S.value.indexOf(l.OPR_HREC_ID);if(console.log("ItemLevel:",e),console.log("Index of OPR_HREC_ID:",d),console.log("APP_LEV:",x.value[d]),d!==-1&&e==x.value[d]){h.value.push(l),console.log(`âœ… SHOW: Item ID ${l.OPR_HREC_ID}`);return}else if(e==0&&!O.value.includes(P.value)){h.value.push(l),console.log(`âœ… SHOW (Level 0): Item ID ${l.OPR_HREC_ID}`);return}console.log(`ðŸš« HIDE: Item ID ${l.OPR_HREC_ID}`)}),console.log(`
ðŸŽ¯ Filtered Data:`,h.value)},z=()=>{g.value=!0},U=async l=>{const e={id:l,remark:N.value},d=await H.put("http://172.22.64.11/49_modelchange/49_mdlchn_api/api/update/std/delete",e);console.log(d.data),d.data.std===!0&&(g.value=!1,$.fire({icon:"success",title:"Delete Successfully",showConfirmButton:!1,timer:1500}).then(()=>{location.reload()}))},C=l=>et(l).format("DD/MM/YYYY"),L=async l=>{E.value=l};f(null);const B=l=>{localStorage.setItem("data",JSON.stringify(l)),Rt("/tech_record")},R=async l=>{(await H.post("http://172.22.64.11/49_modelchange/49_mdlchn_api/api/insert/approve",l)).data.success===!0&&$.fire({icon:"success",title:"à¸ªà¹ˆà¸‡à¸­à¸™à¸¸à¸¡à¸±à¸•à¸´à¸ªà¸³à¹€à¸£à¹‡à¸ˆ",showConfirmButton:!1,timer:1500}).then(()=>{location.reload()})},k=async l=>{const e={...l,APPROVE_BY:P.value,APP_LEV:x.value},d=await H.put("http://172.22.64.11/49_modelchange/49_mdlchn_api/api/update/approve",e);console.log(d.data),d.data.success===!0&&$.fire({icon:"success",title:"à¸­à¸™à¸¸à¸¡à¸±à¸•à¸´à¸ªà¸³à¹€à¸£à¹‡à¸ˆ",showConfirmButton:!1,timer:1500}).then(()=>{location.reload()})};return st(async()=>{await c(),await M(),T()}),(l,e)=>{const d=ot("v-text");return w(),V(W,null,{default:n(()=>[s(nt,{items:h.value,"items-per-page":4,search:a.value},{header:n(()=>[s(_t,{class:"px-2 bg-blue-lighten-2"},{default:n(()=>[t("div",Ft,[s(Q,{modelValue:a.value,"onUpdate:modelValue":e[0]||(e[0]=v=>a.value=v),density:"comfortable",placeholder:"Search","prepend-inner-icon":"mdi mdi-magnify",style:{"max-width":"300px"},variant:"solo",clearable:"","hide-details":""},null,8,["modelValue"]),s(d,{class:"text-xl font-weight-bold"},{default:n(()=>[...e[4]||(e[4]=[r(" Process: CP ",-1)])]),_:1})])]),_:1})]),default:n(({items:v})=>[s(it,{class:"pa-2",fluid:""},{default:n(()=>[s(dt,{dense:""},{default:n(()=>[(w(!0),tt(rt,null,ct(v,u=>(w(),V(ut,{key:u.raw.OPR_HREC_ID,cols:"auto",md:"6"},{default:n(()=>[s(W,{class:"pb-3",border:"",flat:""},{default:n(()=>[s(mt,{class:"mb-2 font-weight-bold"},{title:n(()=>[t("strong",Ut,"Document No. :"+i(u.raw.OPR_HREC_ISSUENO.split("-").pop().slice(-3)),1)]),subtitle:n(()=>[t("table",Bt,[t("tbody",null,[t("tr",Yt,[e[5]||(e[5]=t("th",{class:"w-40 text-left border pa-2 text-sky-800"},"LINE:",-1)),t("td",jt,i(u.raw.OPR_HREC_LINE),1)]),t("tr",Wt,[e[6]||(e[6]=t("th",{class:"text-left border text-sky-800 w-30 pa-2"}," à¸§à¸±à¸™à¸—à¸µà¹ˆà¸šà¸±à¸™à¸—à¸¶à¸: ",-1)),t("td",Gt,i(C(u.raw.OPR_HREC_DATEREC)),1)]),t("tr",zt,[e[7]||(e[7]=t("th",{class:"text-left border pa-2 text-sky-800 w-30"}," Work Order Change: ",-1)),t("td",Jt,i(u.raw.OPR_HREC_WON_CHANGE),1)]),t("tr",qt,[e[8]||(e[8]=t("th",{class:"text-left border pa-2 text-sky-800 w-30"}," Model Change: ",-1)),t("td",Xt,i(u.raw.OPR_HREC_CHNMDLNM),1)])])])]),_:2},1024),t("div",Kt,[s(_,{variant:"flat",color:"primary",rounded:"lg",onClick:m=>L(u.raw)},{default:n(()=>[s(y,{icon:"mdi mdi-file-pdf-box",class:"mr-2"}),e[9]||(e[9]=r(" View PDF ",-1))]),_:1},8,["onClick"]),t("div",Qt,[p.value?.permission==1||p.value?.permission==2||p.value?.permission==7?(w(),V(_,{key:0,variant:"flat",color:"success",rounded:"lg",onClick:m=>R(u.raw)},{default:n(()=>[s(y,{icon:"mdi-check-bold",class:"mr-2"}),e[10]||(e[10]=r(" à¸¢à¸·à¸™à¸¢à¸±à¸™à¸ªà¹ˆà¸‡à¸­à¸™à¸¸à¸¡à¸±à¸•à¸´ ",-1))]),_:1},8,["onClick"])):G("",!0),p.value?.permission==1||p.value?.permission==2||p.value?.permission==7?(w(),V(_,{key:1,variant:"flat",color:"warning",rounded:"lg",onClick:m=>B(u.raw),class:"ms-2"},{default:n(()=>[s(y,{icon:"mdi mdi-text-box-edit",class:"mr-2"}),e[11]||(e[11]=r(" à¹à¸à¹‰à¹„à¸‚à¸‚à¹‰à¸­à¸¡à¸¹à¸¥ ",-1))]),_:1},8,["onClick"])):G("",!0),p.value?.permission==9?(w(),V(pt,{key:2,location:"left bottom",transition:"fade-transition"},{activator:n(({props:m})=>[s(gt,ft({ref_for:!0},m,{color:"blue-accent-3",icon:"mdi-dots-vertical",rounded:"xl"}),null,16)]),default:n(()=>[s(_,{key:"1",rounded:"lg",variant:"flat",color:"green-darken-3",onClick:m=>k(u.raw)},{default:n(()=>[s(y,{icon:"mdi-check-bold",class:"mr-3 pa-3"}),e[12]||(e[12]=t("h1",{class:"text-[16px] font-medium"},"à¸­à¸™à¸¸à¸¡à¸±à¸•à¸´",-1))]),_:1},8,["onClick"]),s(_,{key:"2",rounded:"lg",variant:"flat",color:"red-darken-3",onClick:m=>F(u.raw)},{default:n(()=>[s(y,{icon:"mdi-keyboard-return",class:"mr-3 pa-3"}),e[13]||(e[13]=t("h1",{class:"text-[16px] font-medium"},"à¸ªà¹ˆà¸‡à¸à¸¥à¸±à¸šà¹„à¸›à¹à¸à¹‰à¹„à¸‚",-1))]),_:1},8,["onClick"]),s(_,{key:"3",rounded:"lg",variant:"flat",color:"red-accent-4",onClick:z},{default:n(()=>[s(y,{icon:"mdi-trash-can",class:"mr-3 pa-3"}),e[14]||(e[14]=t("h1",{class:"text-[16px] font-medium"},"à¸¥à¸šà¸—à¸´à¹‰à¸‡",-1))]),_:1})]),_:2},1024)):G("",!0)]),s(vt,{modelValue:g.value,"onUpdate:modelValue":e[3]||(e[3]=m=>g.value=m),"max-width":"400",persistent:""},{default:n(()=>[s(W,{class:"pa-3"},{actions:n(()=>[s(Ct),s(_,{onClick:e[2]||(e[2]=m=>g.value=!1),class:"font-semibold"},{default:n(()=>[...e[15]||(e[15]=[r(" Close ",-1)])]),_:1}),s(_,{onClick:m=>U(u.raw.OPR_HREC_ID),class:"font-semibold"},{default:n(()=>[...e[16]||(e[16]=[r(" à¸¢à¸·à¸™à¸¢à¸±à¸™à¸¥à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥ ",-1)])]),_:1},8,["onClick"])]),default:n(()=>[e[17]||(e[17]=t("div",{class:"mt-3 font-semibold"},"à¸à¸£à¸­à¸à¹€à¸«à¸•à¸¸à¸œà¸¥à¹ƒà¸™à¸à¸²à¸£à¸¥à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥ :",-1)),s(Q,{variant:"outlined",rounded:"md",modelValue:N.value,"onUpdate:modelValue":e[1]||(e[1]=m=>N.value=m)},null,8,["modelValue"])]),_:2},1024)]),_:2},1032,["modelValue"])])]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024),s($t,{"data-item":E.value},null,8,["data-item"])]),footer:n(({page:v,pageCount:u,prevPage:m,nextPage:Y})=>[t("div",Zt,[s(_,{disabled:v===1,density:"comfortable",icon:"mdi mdi-menu-left",variant:"tonal",rounded:"",onClick:m},null,8,["disabled","onClick"]),t("div",te,"Page "+i(v)+" of "+i(u),1),s(_,{disabled:v>=u,density:"comfortable",icon:"mdi mdi-menu-right",variant:"tonal",rounded:"",onClick:Y},null,8,["disabled","onClick"])])]),_:1},8,["items","search"])]),_:1})}}});export{oe as default};
