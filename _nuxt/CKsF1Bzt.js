import{d as C,r,o as T,x as b,B as a,C as t,aa as _,ah as g,ab as d,y as w,a5 as y,D as p,L as I,Q as D,R as h,U as N,W as c,X as f,a3 as M,al as x,a4 as B}from"#entry";import{S as k}from"./Bj_ZQUAw.js";const F=C({__name:"appMaster",setup(P){const u=r([]),i=r([]),o=r([]),n=r([]),S=[{title:"ลำดับ",value:"MASTER_SEQ"},{title:"รหัสพนักงาน",value:"MASTER_EMPID"},{title:"ชื่อพนักงาน",value:"MASTER_NAME"},{title:"Actions",value:"actions",sortable:!1}],A=async()=>{const e={levels:[{level:1,empnos:u.value},{level:2,empnos:i.value},{level:3,empnos:level3.value}]},l=await d.post("http://172.22.64.11/49_modelchange/49_mdlchn_api/api/insert/master",e);console.log(l.data),l.data.success===!0&&k.fire({icon:"success",title:"บันทึกสำเร็จ",showConfirmButton:!1,timer:1500,timerProgressBar:!0}).then(()=>{location.reload()})},V=async()=>{const e=await d.get("http://172.22.64.11/49_modelchange/49_mdlchn_api/api/users");employees_AM.value=e.data.AM,employees_QC.value=e.data.QC,o.value=e.data.ALL},E=async()=>{const e=await d.get("http://172.22.64.11/49_modelchange/49_mdlchn_api/api/approve/users");console.log(e.data),n.value=e.data},R=()=>{n.value=n.value.map(e=>{if(!e.MASTER_EMPID)return e;const s=e.MASTER_EMPID.split(",").map(m=>{const v=o.value.find(U=>U.MUSR_ID===m.trim());return v?v.MUSR_NAME:m});return console.log(s),{...e,MASTER_NAME:s.join(", ")}})};return T(async()=>{await V(),await E(),await R()}),(e,l)=>(w(),b(g,null,[a(_,{class:"pa-4"},{default:t(()=>[a(y,null,{default:t(()=>[...l[2]||(l[2]=[p("สร้างสายอนุมัติ 3 ลำดับ",-1)])]),_:1}),a(I,null,{default:t(()=>[a(D,{ref:"formRef",onSubmit:h(A,["prevent"])},{default:t(()=>[a(N,null,{default:t(()=>[a(c,{cols:"12",sm:"6"},{default:t(()=>[a(f,{modelValue:u.value,"onUpdate:modelValue":l[0]||(l[0]=s=>u.value=s),items:o.value,"item-title":"MUSR_NAME","item-value":"MUSR_ID",label:"ลำดับที่ 1 (เลือกหลายคน)",multiple:"",chips:"",clearable:""},null,8,["modelValue","items"])]),_:1}),a(c,{cols:"12",sm:"6"},{default:t(()=>[a(f,{modelValue:i.value,"onUpdate:modelValue":l[1]||(l[1]=s=>i.value=s),items:o.value,"item-title":"MUSR_NAME","item-value":"MUSR_ID",label:"ลำดับที่ 2 (เลือกหลายคน)",multiple:"",chips:"",clearable:""},null,8,["modelValue","items"])]),_:1}),a(c,{cols:"12",class:"mt-4"},{default:t(()=>[a(M,{color:"primary",type:"submit"},{default:t(()=>[...l[3]||(l[3]=[p("บันทึก",-1)])]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1}),a(_,{class:"mt-4 pa-4"},{default:t(()=>[a(x,{items:n.value,headers:S,class:"mt-4"},{"item.actions":t(({item:s})=>[a(M,{icon:"",color:"red",onClick:m=>e.removeMaster(s.MASTER_ID),size:"small",rounded:"lg"},{default:t(()=>[a(B,null,{default:t(()=>[...l[4]||(l[4]=[p("mdi-delete",-1)])]),_:1})]),_:1},8,["onClick"])]),_:1},8,["items"])]),_:1})],64))}});export{F as default};
