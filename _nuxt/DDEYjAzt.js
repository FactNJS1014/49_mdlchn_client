import{d as w,r as o,o as y,x as C,B as e,C as t,aa as V,ah as T,ab as c,y as I,a5 as D,D as v,L as N,Q as h,R as x,U as B,W as i,X as _,z as k,a3 as S,am as P,a4 as Q}from"#entry";import{S as j}from"./Bj_ZQUAw.js";const z={class:"flex justify-center items-center"},L=w({__name:"appMaster",setup(F){const u=o([]),r=o([]),m=o([]),d=o([]),f=o([]),n=o([]),A=[{title:"ลำดับ",value:"MASTER_SEQ"},{title:"รหัสพนักงาน",value:"MASTER_EMPID"},{title:"ชื่อพนักงาน",value:"MASTER_NAME"},{title:"Actions",value:"actions",sortable:!1}],E=async()=>{const l={levels:[{level:1,empnos:u.value},{level:2,empnos:r.value},{level:3,empnos:m.value}]},a=await c.post("http://172.22.64.11/49_modelchange/49_mdlchn_api/api/insert/master",l);console.log(a.data),a.data.success===!0&&j.fire({icon:"success",title:"บันทึกสำเร็จ",showConfirmButton:!1,timer:1500,timerProgressBar:!0}).then(()=>{location.reload()})},R=async()=>{const l=await c.get("http://172.22.64.11/49_modelchange/49_mdlchn_api/api/users");d.value=l.data.AM,f.value=l.data.QC},U=async()=>{const l=await c.get("http://172.22.64.11/49_modelchange/49_mdlchn_api/api/approve/users");console.log(l.data),n.value=l.data},b=()=>{n.value=n.value.map(l=>{if(!l.MASTER_EMPID)return l;const s=l.MASTER_EMPID.split(",").map(p=>{const M=employees.value.find(g=>g.MUSR_ID===p.trim());return M?M.MUSR_NAME:p});return{...l,MASTER_NAME:s.join(", ")}})};return y(async()=>{await R(),await U(),await b()}),(l,a)=>(I(),C(T,null,[e(V,{class:"pa-4"},{default:t(()=>[e(D,null,{default:t(()=>[...a[3]||(a[3]=[v("สร้างสายอนุมัติ 2 ลำดับ",-1)])]),_:1}),e(N,null,{default:t(()=>[e(h,{ref:"formRef",onSubmit:x(E,["prevent"])},{default:t(()=>[e(B,null,{default:t(()=>[e(i,{cols:"12",sm:"6"},{default:t(()=>[e(_,{modelValue:u.value,"onUpdate:modelValue":a[0]||(a[0]=s=>u.value=s),items:d.value,"item-title":"MUSR_NAME","item-value":"MUSR_ID",variant:"outlined",label:"ลำดับที่ 1 (เลือกหลายคน)",multiple:"",chips:"",clearable:""},null,8,["modelValue","items"])]),_:1}),e(i,{cols:"12",sm:"6"},{default:t(()=>[e(_,{modelValue:r.value,"onUpdate:modelValue":a[1]||(a[1]=s=>r.value=s),items:d.value,"item-title":"MUSR_NAME","item-value":"MUSR_ID",variant:"outlined",label:"ลำดับที่ 2 (เลือกหลายคน)",multiple:"",chips:"",clearable:""},null,8,["modelValue","items"])]),_:1}),e(i,{cols:"12",sm:"6"},{default:t(()=>[e(_,{modelValue:m.value,"onUpdate:modelValue":a[2]||(a[2]=s=>m.value=s),items:f.value,"item-title":"MUSR_NAME","item-value":"MUSR_ID",variant:"outlined",label:"ลำดับที่ 3 (เลือกหลายคน)",multiple:"",chips:"",clearable:""},null,8,["modelValue","items"])]),_:1}),e(i,{cols:"12",class:"mt-4"},{default:t(()=>[k("div",z,[e(S,{color:"primary",type:"submit",rounded:"lg",width:"300px","prepend-icon":"mdi mdi-content-save-settings"},{default:t(()=>[...a[4]||(a[4]=[v("บันทึก",-1)])]),_:1})])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1}),e(V,{class:"mt-4 pa-4"},{default:t(()=>[e(P,{items:n.value,headers:A,class:"mt-4"},{"item.actions":t(({item:s})=>[e(S,{icon:"",color:"red",onClick:p=>l.removeMaster(s.MASTER_ID),size:"small",rounded:"lg"},{default:t(()=>[e(Q,null,{default:t(()=>[...a[5]||(a[5]=[v("mdi-delete",-1)])]),_:1})]),_:1},8,["onClick"])]),_:1},8,["items"])]),_:1})],64))}});export{L as default};
