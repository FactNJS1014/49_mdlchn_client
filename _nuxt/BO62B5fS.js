import{d as T,r,o as g,x as w,B as e,C as l,aa as _,ag as b,y as C,a5 as I,D as d,L as y,Q as D,R as N,U as h,W as p,X as f,a3 as M,ak as x,a4 as B}from"#entry";import{a as c}from"./ngrFHoWO.js";import{S as k}from"./Bj_ZQUAw.js";const W=T({__name:"appMaster",setup(P){const i=r([]),u=r([]),o=r([]),n=r([]),S=[{title:"ลำดับ",value:"MASTER_SEQ"},{title:"รหัสพนักงาน",value:"MASTER_EMPID"},{title:"ชื่อพนักงาน",value:"MASTER_NAME"},{title:"Actions",value:"actions",sortable:!1}],V=async()=>{const t={levels:[{level:1,empnos:i.value},{level:2,empnos:u.value}]},a=await c.post("http://172.22.64.11/49_modelchange/49_mdlchn_api/api/insert/master",t);console.log(a.data),a.data.success===!0&&k.fire({icon:"success",title:"บันทึกสำเร็จ",showConfirmButton:!1,timer:1500,timerProgressBar:!0}).then(()=>{location.reload()})},E=async()=>{const t=await c.get("http://172.22.64.11/49_modelchange/49_mdlchn_api/api/users");o.value=t.data},R=async()=>{const t=await c.get("http://172.22.64.11/49_modelchange/49_mdlchn_api/api/approve/users");console.log(t.data),n.value=t.data},A=()=>{n.value=n.value.map(t=>{if(!t.MASTER_EMPID)return t;const s=t.MASTER_EMPID.split(",").map(m=>{const v=o.value.find(U=>U.MUSR_ID===m.trim());return v?v.MUSR_NAME:m});return{...t,MASTER_NAME:s.join(", ")}})};return g(async()=>{await E(),await R(),await A()}),(t,a)=>(C(),w(b,null,[e(_,{class:"pa-4"},{default:l(()=>[e(I,null,{default:l(()=>[...a[2]||(a[2]=[d("สร้างสายอนุมัติ 2 ลำดับ",-1)])]),_:1}),e(y,null,{default:l(()=>[e(D,{ref:"formRef",onSubmit:N(V,["prevent"])},{default:l(()=>[e(h,null,{default:l(()=>[e(p,{cols:"12",sm:"6"},{default:l(()=>[e(f,{modelValue:i.value,"onUpdate:modelValue":a[0]||(a[0]=s=>i.value=s),items:o.value,"item-title":"MUSR_NAME","item-value":"MUSR_ID",label:"ลำดับที่ 1 (เลือกหลายคน)",multiple:"",chips:"",clearable:""},null,8,["modelValue","items"])]),_:1}),e(p,{cols:"12",sm:"6"},{default:l(()=>[e(f,{modelValue:u.value,"onUpdate:modelValue":a[1]||(a[1]=s=>u.value=s),items:o.value,"item-title":"MUSR_NAME","item-value":"MUSR_ID",label:"ลำดับที่ 2 (เลือกหลายคน)",multiple:"",chips:"",clearable:""},null,8,["modelValue","items"])]),_:1}),e(p,{cols:"12",class:"mt-4"},{default:l(()=>[e(M,{color:"primary",type:"submit"},{default:l(()=>[...a[3]||(a[3]=[d("บันทึก",-1)])]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1}),e(_,{class:"mt-4 pa-4"},{default:l(()=>[e(x,{items:n.value,headers:S,class:"mt-4"},{"item.actions":l(({item:s})=>[e(M,{icon:"",color:"red",onClick:m=>t.removeMaster(s.MASTER_ID),size:"small",rounded:"lg"},{default:l(()=>[e(B,null,{default:l(()=>[...a[4]||(a[4]=[d("mdi-delete",-1)])]),_:1})]),_:1},8,["onClick"])]),_:1},8,["items"])]),_:1})],64))}});export{W as default};
