import{d as C,r as o,o as w,x as T,B as a,C as t,aa as A,ah as I,ab as v,y as D,a5 as N,D as f,L as B,Q as h,R as L,U as Q,W as i,z as u,X as M,a3 as b,al as k,a4 as P}from"#entry";import{S as j}from"./Bj_ZQUAw.js";const z={class:"flex justify-center items-center"},X=C({__name:"appMaster",setup(F){const m=o([]),r=o([]),d=o([]),p=o([]),_=o([]),S=o([]),n=o([]),g=[{title:"ลำดับ",value:"MASTER_SEQ"},{title:"รหัสพนักงาน",value:"MASTER_EMPID"},{title:"ชื่อพนักงาน",value:"MASTER_NAME"},{title:"Actions",value:"actions",sortable:!1}],E=async()=>{const l={levels:[{level:1,empnos:m.value},{level:2,empnos:r.value},{level:3,empnos:d.value}]},e=await v.post("http://172.22.64.11/49_modelchange/49_mdlchn_api/api/insert/master",l);console.log(e.data),e.data.success===!0&&j.fire({icon:"success",title:"บันทึกสำเร็จ",showConfirmButton:!1,timer:1500,timerProgressBar:!0}).then(()=>{location.reload()})},R=async()=>{const l=await v.get("http://172.22.64.11/49_modelchange/49_mdlchn_api/api/users");p.value=l.data.AM,_.value=l.data.QC,S.value=l.data.ALL},U=async()=>{const l=await v.get("http://172.22.64.11/49_modelchange/49_mdlchn_api/api/approve/users");console.log(l.data),n.value=l.data},x=()=>{n.value=n.value.map(l=>{if(!l.MASTER_EMPID)return l;const s=l.MASTER_EMPID.split(",").map(c=>{const V=S.value.find(y=>y.MUSR_ID===c.trim());return V?V.MUSR_NAME:c});return console.log(s),{...l,MASTER_NAME:s.join(", ")}})};return w(async()=>{await R(),await U(),await x()}),(l,e)=>(D(),T(I,null,[a(A,{class:"pa-4"},{default:t(()=>[a(N,null,{default:t(()=>[...e[3]||(e[3]=[f("สร้างสายอนุมัติ 3 ลำดับ",-1)])]),_:1}),a(B,null,{default:t(()=>[a(h,{ref:"formRef",onSubmit:L(E,["prevent"])},{default:t(()=>[a(Q,null,{default:t(()=>[a(i,{cols:"12",sm:"6"},{default:t(()=>[e[4]||(e[4]=u("div",{class:"mt-3 font-semibold text-xl bg-cyan-lighten-3 pa-1"}," ลำดับที่ 1: AM Sub Leader ",-1)),a(M,{modelValue:m.value,"onUpdate:modelValue":e[0]||(e[0]=s=>m.value=s),items:p.value,"item-title":"MUSR_NAME","item-value":"MUSR_ID",variant:"outlined",label:"ลำดับที่ 1 (เลือกหลายคน)",multiple:"",chips:"",clearable:""},null,8,["modelValue","items"])]),_:1}),a(i,{cols:"12",sm:"6"},{default:t(()=>[e[5]||(e[5]=u("div",{class:"mt-3 font-semibold text-xl bg-cyan-lighten-1 pa-1"}," ลำดับที่ 2: AM Leader ",-1)),a(M,{modelValue:r.value,"onUpdate:modelValue":e[1]||(e[1]=s=>r.value=s),items:p.value,"item-title":"MUSR_NAME","item-value":"MUSR_ID",variant:"outlined",label:"ลำดับที่ 2 (เลือกหลายคน)",multiple:"",chips:"",clearable:""},null,8,["modelValue","items"])]),_:1}),a(i,{cols:"12",sm:"6"},{default:t(()=>[e[6]||(e[6]=u("div",{class:"mt-3 font-semibold text-xl bg-teal-accent-3 pa-1"}," ลำดับที่ 3: QC ",-1)),a(M,{modelValue:d.value,"onUpdate:modelValue":e[2]||(e[2]=s=>d.value=s),items:_.value,"item-title":"MUSR_NAME","item-value":"MUSR_ID",variant:"outlined",label:"ลำดับที่ 3 (เลือกหลายคน)",multiple:"",chips:"",clearable:""},null,8,["modelValue","items"])]),_:1}),a(i,{cols:"12",class:"mt-4"},{default:t(()=>[u("div",z,[a(b,{color:"primary",type:"submit",rounded:"lg",width:"300px","prepend-icon":"mdi mdi-content-save-settings"},{default:t(()=>[...e[7]||(e[7]=[f("บันทึก",-1)])]),_:1})])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1}),a(A,{class:"mt-4 pa-4"},{default:t(()=>[a(k,{items:n.value,headers:g,class:"mt-4"},{"item.actions":t(({item:s})=>[a(b,{icon:"",color:"red",onClick:c=>l.removeMaster(s.MASTER_ID),size:"small",rounded:"lg"},{default:t(()=>[a(P,null,{default:t(()=>[...e[8]||(e[8]=[f("mdi-delete",-1)])]),_:1})]),_:1},8,["onClick"])]),_:1},8,["items"])]),_:1})],64))}});export{X as default};
