import{an as v,d,ao as x,r as n,ac as y,n as f,k as w,o as _,ab as b,I as A,y as C,C as u,B as i,ap as B,z as m,aq as V,a4 as k,A as N,ar as R,ag as S,as as M,at as U}from"#entry";const $=v("/blockchain.png"),I=d({__name:"sidebar",setup(h){const r=x(),c=n(r.path);y(()=>r.path,a=>{c.value=a});const l=n([{id:1,icon:"mdi mdi-database-cog",to:"/appMaster",label:"สายอนุมัติ",permissions:[9,8]},{id:2,icon:"mdi mdi-numeric-1-box",to:"/",label:"แบบฟอร์ม Operator",permissions:[1,2,3,8,9]},{id:3,icon:"mdi mdi-numeric-2-box",to:"/tech_record",label:"แบบฟอร์ม Technichian",permissions:[2,3,4,8,9]},{id:4,icon:"mdi mdi-file-document-check",to:"/dataApp",label:"เอกสารอนุมัติ CP Process",permissions:[8,9]},{id:5,icon:"mdi mdi-file-document-check",to:"/dataRf",label:"เอกสารอนุมัติ RF Process",permissions:[8,9]}]),{public:p}=f(),o=n(null),e=n([]),g=async()=>{try{const a=await b.get(`${p.apiBase}/session/user`,{withCredentials:!0});o.value=a.data;let s=o.value.permission;s?typeof s=="string"?e.value=s.split(",").map(t=>Number(t.trim())).filter(t=>!isNaN(t)):Array.isArray(s)?e.value=s.map(t=>Number(t)):e.value=[Number(s)]:e.value=[],console.log("✅ permission array:",e.value)}catch(a){console.error("❌ sessionUser error:",a),e.value=[]}};return w(()=>{const a=Array.isArray(e.value)?e.value:[];return l.value.filter(s=>s.permissions.some(t=>a.includes(t)))}),_(()=>{g()}),()=>{}}}),P=Object.assign(I,{__name:"Sidebar"}),j={class:"flex items-center gap-3"},z={class:"flex items-center gap-2 ml-auto"},L={class:"text-white font-medium"},q=d({__name:"custom",setup(h){const{public:r}=f();console.log(r.apiBase);const c=n(null),l=n(""),p=async()=>{const o=await b.get(`${r.apiBase}/session/user`,{withCredentials:!0});c.value=o.data,console.log("user session:",c.value),l.value=c.value?.username||""};return _(()=>{p()}),(o,e)=>(C(),A(U,null,{default:u(()=>[i(B,{app:"",color:"blue",class:"px-4 flex justify-between items-center"},{default:u(()=>[m("div",j,[i(V,{src:$,alt:"Logo",width:"32",height:"32",contain:""}),e[0]||(e[0]=m("span",{class:"font-bold text-white text-xl tracking-wide"}," Model Change Record System ",-1))]),m("div",z,[i(k,{icon:"mdi-account-circle",size:"26",color:"white"}),m("span",L,N(l.value),1)])]),_:1}),i(P),i(R,{class:"p-4"},{default:u(()=>[i(S,null,{default:u(()=>[M(o.$slots,"default")]),_:3})]),_:3})]),_:3}))}});export{q as default};
